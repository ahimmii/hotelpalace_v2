{% extends 'base.html' %}
{% block title %}Reservation{% endblock %}

{% block content %}
{% load tz %}
<div class="new_appointment main_container">
    <div class="row page-titles mx-0">
        <div class="col-sm-6 p-md-0">
            <div class="welcome-text">
                <h4 class="text-primary">Reservation</h4>
                <p class="mb-0"></p>
            </div>
        </div>
        <div class="col-sm-6 p-md-0 justify-content-sm-end mt-2 mt-sm-0 d-flex">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="/">Home</a></li>
                <li class="breadcrumb-item active"><a href="/appointment">Reservation</a>
                </li>
            </ol>
        </div>
    </div>
    <div class="row">
        <div class="col-sm-6 col-xl-3 col-lg-6">
            <div class="widget card card-primary bg-card1">
                <div class="card-body">
                    <div class="media text-center">
                        <span>
                            <i class="fas fa-wallet fa-2x"></i>
                        </span>
                        <div class="media-body">
                            <span class="text-white">Total Revenue</span>
                            <h3 class="mb-0 text-white" id="totalEnterOutput"></h3>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-sm-6 col-xl-3 col-lg-6">
            <div class="widget card card-primary bg-card1">
                <div class="card-body">
                    <div class="media text-center">
                        <span>
                            <i class="fas fa-wallet fa-2x"></i>
                        </span>
                        <div class="media-body">
                            <span class="text-white">Total Sortie</span>
                            <h3 class="mb-0 text-white" id="totalSortieOutput"></h3>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-sm-6 col-xl-3 col-lg-6">
            <div class="widget card card-primary bg-card1">
                <div class="card-body">
                    <div class="media text-center">
                        <span>
                            <i class="fas fa-wallet fa-2x"></i>
                        </span>
                        <div class="media-body">
                            <span class="text-white">Net income</span>
                            <h3 class="mb-0 text-white" id="totalPriceOutput"></h3>
                            <h3 class="mb-0 text-white"></h3>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-sm-6 col-xl-3 col-lg-6">
            <div class="widget card card-primary bg-card1">
                <div class="card-body">
                    <div class="media text-center">
                        <span>
                            <i class="fas fa-wallet fa-2x"></i>
                        </span>
                        <div class="media-body">
                            <span class="text-white">Total Cash / Cart</span>
                            <h3 class="mb-0 text-white" id="modepaimentCash">/</h3>
                            <h3 class="mb-0 text-white" id="modepaimentCart"></h3>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
        
    <div class="row">
        <div class="col-lg-12">
            <div class="card shadow">
                <div class="card-header">
                    <div class="row m-rl w-100">
                        <div class="col-lg-3 col-sm-12">
                            <label for="Date">Date</label>
                            <div class="form-group">
                                <input id="daterange" class="form-control input-daterange-datepicker">
                            </div>
                        </div>
                        <div class="col-lg-3 col-sm-12">
                            <label for="Search">Search</label>
                            <div class="form-group">
                                <input id="myInputTextField" class="form-control" type="search"
                                    placeholder="Search by patient's name or phone number" aria-label="Search">
                            </div>
                        </div>
                        <div class="col-lg-3 col-sm-12">
                            <div class="form-group">
                                <label for="priceFilter">Filter by Price</label>
                                <select id="priceFilter" class="form-control form-select" onchange="filterByPrice()">
                                    <option value="all">All</option>
                                    <option value="positive">Revenue</option>
                                    <option value="negative">Sortie</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-lg-3 col-sm-12">
                            <label for="add"><br></label>
                            <div class="form-group">
                                <button type="button" class="btn btn-primary w-100 h-56" data-bs-toggle="modal"
                                    data-bs-target="#newAppointment">New
                                    Reservation</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="row">
        <div class="col-md-12">
            <div class="card shadow">
                <div class="card-body">
                    <div class="table-responsive">
                        <table id="example3" class="display nowrap">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Date</th>
                                    <th>Name</th>
                                    <th>type</th>
                                    <th>Chamber</th>
                                    <th>Num phone</th>
                                    <th>Prix</th>
                                    <th>Prix R</th>
                                    <th>Type payment</th>
                                    <th>User</th>
                                    <th>definition</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for appointment_data in appointments %}

                                <tr id="{{appointment_data.id}}">

                                    <td class="id-column">
                                        {{ appointment_data.id }}</td>
                                    <td class="Fait-column">{{ appointment_data.Fait}}</td>
                                    <td class="name-column">{{appointment_data.prenom }} {{ appointment_data.nom }}</td>
                                    <td class="Domicile-column">{{ appointment_data.Typedereservation}}</td>
                                    <td class="N_chamber-column">{{ appointment_data.N_chamber }}</td>
                                    <td class="PrixR-column">{{ appointment_data.Num_phone }}</td>
                                    
                                    <td class="Prix-column">{{ appointment_data.Prix }}</td>
                                    
                                    <td class="PrixR-column">{{ appointment_data.Prix_R }}</td>
                                    
                                    
                                    <td class="modepaiment-column">{{ appointment_data.modepaiment }}</td>
                                    <td class="User-column">
                                        {{ appointment_data.User }}
                                    </td>
                                    {% if appointment_data.filePath != "f" %}
                                    <td class="filePath-column" > <a href="{{ appointment_data.filePath }}">
                                        <span class="badge badge-primary" >definition </span>
                                    </a></td>
                                    {% else %}
                                    <td class="filePath-column" ></td>
                                    {% endif %}
                                    <div class="id-column  d-none" id="{{appointment_data.id}}">
                                        {{appointment_data.id|default:"NoPatient_id Data" }}</div>
                                    <div class="start-column  d-none" id="start{{appointment_data.id}}">{{
                                        appointment_data.start|default:"No start Data"}}</div>
                                    <div class="end-column  d-none" id="end{{appointment_data.id}}">{{
                                        appointment_data.end|default:"No end Data" }}</div>
                                    <div class="totalPrice-column  d-none" id="totalPrice_{{appointment_data.id}}">{{
                                        appointment_data.totalPrice|default:"NototalPrice Data" }}</div>
                                    <div class="amountPaid-column  d-none" id="amountPaid_{{appointment_data.id}}">{{
                                        appointment_data.amountPaid|default:"NoamountPaid Data" }}</div>
                                    <div class="Statut_de_paiement-column  d-none"
                                        id="Statut_de_paiement_{{appointment_data.id}}">
                                        {{appointment_data.Statut_de_paiement|default:"No Statut_de_paiement Data" }}
                                    </div>
                                    <div class="typeAppointment-column  d-none"
                                        id="typeAppointment_{{appointment_data.id}}">
                                        {{appointment_data.typeAppointment|default:"No typeAppointment Data" }}</div>
                                    <div class="Motif-column  d-none" id="Motif_{{appointment_data.id}}">{{
                                        appointment_data.Motif|default:"No Motif Data"}}</div>
                                    <!-- <td class="email-column  d-none">{{ value.Email|default:"No  Data" }}</td>
                                    <td class="email-column  d-none">{{ value.Email|default:"No Email Data" }}</td>
                                    <td class="email-column  d-none">{{ value.Email|default:"No Email Data" }}</td> -->
                                    

                                    <td>
                                        <!-- <a class='mr-4 vue' data-bs-toggle="modal" data-bs-target="#exampleModalCenter">
                                            <span class='fas fa-user tbl-user' aria-hidden='true'></span>
                                        </a> -->

                                        <a class=' mr-4 edit' data-bs-toggle='modal'
                                            data-row-id="{{ appointment_data.id }}"
                                            data-row-nom="{{ appointment_data.nom }}"
                                            data-row-prenom="{{ appointment_data.prenom }}"
                                            data-row-Fait="{{ appointment_data.Fait }}"
                                            data-row-filePath="{{ appointment_data.url }}"
                                            data-row-N-chamber="{{ appointment_data.N_chamber }}"
                                            data-row-Num-phone="{{ appointment_data.Num_phone }}"
                                            data-row-Prix="{{ appointment_data.Prix }}"
                                            data-row-Prix-R="{{ appointment_data.Prix_R }}"
                                            data-row-N_T="{{ appointment_data.User }}"
                                            data-row-Typedereservation="{{ appointment_data.Typedereservation }}"
                                            data-row-modepaiment="{{ appointment_data.modepaiment }}"
                                            data-row-Check-in="{{ appointment_data.Check_in }}"
                                            data-row-Check-out="{{ appointment_data.Check_out }}"
                                            data-bs-target='#changeTimeAndDate'>
                                            <span class='fas fa-pencil-alt tbl-edit'></span>
                                        </a>
                                        <a class="delete" data-bs-toggle="modal"
                                            onclick="deleteAppointment('{{appointment_data.id}}')"
                                            data-bs-target="#confirmDelete">
                                            <span class="fas fa-trash-alt tbl-delete"></span>
                                        </a>

                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- End section content -->





<!-- Modal  -->
<div class="modal fade" id="exampleModalCenter" tabindex="-1" aria-labelledby="modal-title-head-modal"
    aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="modal-title-head-modal">Michael R Sheets</h5>
                <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close"> <span
                        aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <h5>Motif Patient</h5>
                <p>Caregivers can be spouses, family members, friends, or even a close neighbor. As a caregiver,
                    you are an integral part of the team. Moffitt is based on the core concept of Patient and
                    Family-Centered Care which in short is a partnership
                    between you, the patient and the medical treatment team. As part of the team, you will help
                    coordinate the patient’s care. That said, you must also make sure you are taking care of
                    yourself.
                </p>
                <hr>
                <form>
                    <div class="form-group">
                        <label>Review doctors</label>
                        <textarea class="form-control" rows="3"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn badge-primary">Save changes</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="changeTimeAndDate" tabindex="-1" role="dialog" aria-labelledby="modal-title-edit-modal">
    <div class="modal-dialog modal-lg modal-dialog-centered" role="document">

        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabelOne"> Update appointment </h5>
                <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close"><span
                        aria-hidden="true">&times;</span></button>
            </div>

            <div class="modal-body">
                <form class="row align-items-start" id="eventForm">
                    {% csrf_token %}
                    <input type="hidden" id="id_input" value="">
                    <div class="col-md-6 col-sm-12 form-group">
                        <label for="endDate">First Name</label>
                        <input class="form-control" id="ferst_Name_update">
                    </div>
                    <div class="col-md-6 col-sm-12 form-group">
                        <label for="endDate">Last Name</label>
                        <input class="form-control" id="last_name_update">
                    </div>
                    <div class="col-md-12 col-sm-12 form-group">
                        <label for="remainingAmount">Room number</label>

                        <select id="chamber_update" class=" select2 " style="width: 100%;" multiple="multiple">
                            <option value="01">01</option>
                            <option value="02">02</option>
                            <option value="03">03</option>
                            <option value="04">04</option>
                            <option value="05">05</option>
                            <option value="06">06</option>
                            <option value="07">07</option>
                            <option value="08">08</option>
                            <option value="09">09</option>
                            <option value="10">10</option>
                            <option value="11">11</option>
                            <option value="12">12</option>
                            <option value="13">13</option>
                            <option value="14">14</option>
                            <option value="15">15</option>
                            <option value="16">16</option>
                            <option value="17">17</option>
                            <option value="18">18</option>
                            <option value="19">19</option>
                            <option value="20">20</option>
                            <option value="21">21</option>
                            <option value="22">22</option>
                            <option value="23">23</option>
                            <option value="24">24</option>
                            <option value="25">25</option>
                            <option value="26">26</option>
                            <option value="27">27</option>
                            <option value="28">28</option>
                            <option value="29">29</option>
                            <option value="30">30</option>
                            <option value="31">31</option>
                            <option value="32">32</option>
                            <option value="33">33</option>
                            <option value="34">34</option>
                            <option value="35">35</option>
                        </select>
                    
                    </div>

                    <div class="col-md-6 col-sm-12 form-group">
                        <label for="startDate">Start Date</label>
                        <input class="form-control" id="startDate_update" type="date">
                    </div>
                    <div class="col-md-6 col-sm-12 form-group">
                        <label for="endDate">End Date</label>
                        <input class="form-control" id="endDate_update" type="date">
                    </div>

                    <!-- Add these fields inside the modal-body div -->
                    <div class="col-md-6 col-sm-12 form-group">
                        <label for="totalPrice">Total Price</label>
                        <input class="form-control" id="totalPrice_update" 
                            type="number" min="0">
                    </div>
                    <div class="col-md-6 col-sm-12 form-group">
                        <label for="amountPaid">Rest Price</label>
                        <input class="form-control" id="amountPaid_update"
                            type="number" min="0">

                    </div>
                    <div class="col-md-6 col-sm-12 form-group">
                        <label for="remainingAmount">Type of Paiment</label>
                        <select id="modepaiment_update" class="form-control form-select">
                            <option value="Cash">Cash</option>
                            <option value="Visa Card">Visa Card</option>
                            <option value="bank transfer">bank transfer</option>
                        </select>
                    </div>
                    <div class="col-md-6 col-sm-12 form-group">
                        <label for="Num_phone">Number phone</label>
                        <input class="form-control" id="Num_phone_update"
                            type="number" min="0">

                    </div>
                    <div class="col-md-12 col-sm-12 form-group">
                        <label for="remainingAmount">User</label>

                        <select id="N_T_update" class="form-control form-select">
                            <option value="ELYAKKEN">ELYAKKEN</option>
                            <option value="SOUAD">SOUAD</option>
                            <option value="JAMAL">JAMAL</option>
                            <option value="ADMIN">ADMIN</option>
                        </select>
                        
                    </div>
                    <div class="col-md-12 col-sm-12 form-group">
                        <label for="remainingAmount">Type of Reservation</label>
                    
                        <select id="Typedereservation_update" class="form-control form-select">
                            <option value="Booking">Booking</option>
                            <option value="directly">Directly</option>
                            <option value="In">In</option>
                            <option value="Smsar">Smsar</option>
                            <option value="Expedia Group">Expedia Group</option>
                            <option value="Airbnb">Airbnb</option>
                            <option value="Instagram">Instagram</option>
                            <option value="Reservation">Reservation</option>
                            <option value="Avance">Avance</option>
                            <option value="Other">Other</option>
                        </select>
                    
                    </div>
                    
                    <div class="col-md-6 col-sm-12 form-group">
                        <label for="endDate">Date</label>
                        <input class="form-control" id="FaitDate_update" type="date" pattern="\d{2}/\d{2}/\d{4}" placeholder="DD/MM/YYYY" title="Enter a date in DD/MM/YYYY format">
                    </div>
                    
                    <div class="col-md-6 col-sm-12 form-group">
                        <label for="url">Enter Definition:</label>
                        <input type="file" id="filePath_update"  accept=".png, .jpg, .pdf">
                         <div id="pdfViewer"></div>
                    </div>
                    <br>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn badge-primary" onclick="submitForm()">Save Changes</button>
                <button type="button" class="btn badge-success" onclick="add()">Add Reservation</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade selectRefresh" id="newAppointment" tabindex="-1" aria-labelledby="exampleModalLabelOne">
    <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabelOne"> New Reservation </h5>
                <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close"><span
                        aria-hidden="true">&times;</span></button>
            </div>

            <div class="modal-body">
                <form method="POST" class="row align-items-start" id="eventForm" action="{% url 'appointment_list' %}">
                    {% csrf_token %}
                    <input type="hidden" id="id_input" value="">
                    <div class="col-md-6 col-sm-12 form-group">
                        <label for="endDate">First Name</label>
                        <input class="form-control" id="ferst_Name">
                    </div>
                    <div class="col-md-6 col-sm-12 form-group">
                        <label for="endDate">Last Name</label>
                        <input class="form-control" id="last_name">
                    </div>
                    <div class="col-md-12 col-sm-12 form-group">
                        <label for="remainingAmount">Room number</label>

                        <select id="chamber" class=" select2 " style="width: 100%;" multiple="multiple">
                            {% for chamber in N_chamber_T %}
                            <option value="{{ chamber }}">{{ chamber }}</option>
                            {% endfor %}
                        </select>
                        
                    </div>
                    
                    <div class="col-md-6 col-sm-12 form-group">
                        <label for="startDate">Start Date</label>
                        <input class="form-control" id="startDate" type="date" pattern="\d{2}/\d{2}/\d{4}" placeholder="DD/MM/YYYY" title="Enter a date in DD/MM/YYYY format">
                    </div>
                    <div class="col-md-6 col-sm-12 form-group">
                        <label for="endDate">End Date</label>
                        <input class="form-control" id="endDate" type="date" pattern="\d{2}/\d{2}/\d{4}" placeholder="DD/MM/YYYY" title="Enter a date in DD/MM/YYYY format">
                    </div>

                    <!-- Add these fields inside the modal-body div -->
                    <div class="col-md-6 col-sm-12 form-group">
                        <label for="totalPrice">Total Price</label>
                        <input class="form-control" id="totalPrice"  type="number"
                            min="0">
                    </div>
                    <div class="col-md-6 col-sm-12 form-group">
                        <label for="amountPaid">Rest Price</label>
                        <input class="form-control" id="amountPaid" type="number"
                            min="0">
                    </div>
                    <div class="col-md-6 col-sm-12 form-group">
                        <label for="remainingAmount">Type of Paiment</label>
                        <select id="modepaiment" class="form-control form-select">
                            <option value="Cash">Cash</option>
                            <option value="Visa Card">Visa Card</option>
                            <option value="bank transfer">bank transfer</option>
                        </select>
                    </div>
                    <div class="col-md-6 col-sm-12 form-group">
                        <label for="Num_phone">Number phone</label>
                        <input class="form-control" id="Num_phone"
                            type="number" min="0">
                    </div>
                    <div class="col-md-12 col-sm-12 form-group">
                        <label for="remainingAmount">User</label>

                        <select id="N_T" class="form-control form-select">
                            <option value="ELYAKKEN">ELYAKKEN</option>
                            <option value="SOUAD">SOUAD</option>
                            <option value="JAMAL">JAMAL</option>
                            <option value="ADMIN">ADMIN</option>
                        </select>

                    </div>
                    <div class="col-md-12 col-sm-12 form-group">
                        <label for="remainingAmount">Type of Reservation</label>

                        <select id="typeAppointment" class="form-control form-select">
                            <option value="Booking">Booking</option>
                            <option value="directly">Directly</option>
                            <option value="In">In</option>
                            <option value="Smsar">Smsar</option>
                            <option value="Expedia Group">Expedia Group</option>
                            <option value="Airbnb">Airbnb</option>
                            <option value="Instagram">Instagram</option>
                            <option value="Reservation">Reservation</option>
                            <option value="Avance">Avance</option>
                            <option value="Other">Other</option>
                        </select>

                    </div>
                    
                    <div class="col-md-6 col-sm-12 form-group">
                        <label for="endDate">Date</label>
                        <input class="form-control" id="FaitDate" type="date" pattern="\d{2}/\d{2}/\d{4}" placeholder="DD/MM/YYYY" title="Enter a date in DD/MM/YYYY format">
                    </div>
                    <div class="col-md-6 col-sm-12 form-group">
                        <label for="url">Enter Definition:</label>
                        <input type="file" id="filePath" accept=".png, .jpg, .pdf">
                    </div>
                    {% comment %} <div class="col-lg-12">
                        <div class="form-group">
                            <label>Motif Patient</label>
                            <textarea id="motif" class="form-control" rows="3"></textarea>
                        </div>
                    </div> {% endcomment %}
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn badge-primary" onclick="addEvent()">Save changes</button>
            </div>
        </div>
    </div>
</div>

<!-- End Modal  -->


<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script> 
<script>
   
    const url = "{% url 'calendar_save' %}";
    var updateUrl = "{% url 'appointment_edit' pk='pk_placeholder' %}";
    var deleteUrl = "{% url 'appointment_delete' pk='pk_placeholder' %}";

    $(document).ready(function() {
        $('.select2').select2({
            placeholder: "Select a Room",
            allowClear: true
        });
    });

    function convertDate(input) {
        // Split the input into date and time components
        let [year, month, dayTime] = input.split('-');
        let [day] = dayTime.split('T');

        

        // Return the formatted date
        return `${year}-${month}-${day}`;
    }

    function loadPdfFromPath() {
            // This function simulates loading the PDF file from a predefined path
            // In a real-world scenario, this would be done on the server side
            fetch('C:/Users/HP PLAZA/Documents/SCANNER/IMG_20240530_0007.pdf')
                .then(response => response.blob())
                .then(blob => {
                    const file = new File([blob], 'IMG_20240530_0007.pdf', { type: 'application/pdf' });
                    const dataTransfer = new DataTransfer();
                    dataTransfer.items.add(file);
                    document.getElementById('filePath').files = dataTransfer.files;
                    const event = new Event('change');
                    document.getElementById('filePath').dispatchEvent(event);
                })
                .catch(error => {
                    console.error('Error loading PDF:', error);
                });
        }

    //////////////////////////// Check For Edit CLICK /////////////////////////
    document.querySelectorAll('.edit').forEach(function (button) {
        button.addEventListener('click', function () {
            //////// GET DATA //////////
            var rowId = this.getAttribute('data-row-id');
            // console.log('Row ID:', rowId);
            var rowNom = this.getAttribute('data-row-nom');
            var rowPrenom = this.getAttribute('data-row-prenom');
            var rowFait = this.getAttribute('data-row-Fait');
            var rowN_chamber = this.getAttribute('data-row-N-chamber');
            var rowNum_phone = this.getAttribute('data-row-Num-phone');
            var rowfilePath = this.getAttribute('data-row-filePath') ?? null;
            var rowPrix = this.getAttribute('data-row-Prix');
            var rowN_T = this.getAttribute('data-row-N_T');
            var rowTypedereservation = this.getAttribute('data-row-Typedereservation');
            var rowmodepaiment = this.getAttribute('data-row-modepaiment');
            // var rowPrixR = this.getAttribute('data-row-Prix-R');
            var formattedCheckIn = this.getAttribute('data-row-Check-in');
            // Example usage within an event handler or function where 'this' is bound to the element
            var formattedCheckOut = this.getAttribute('data-row-Check-out');
            

           
            var rowCheckOut = convertDate(formattedCheckOut);
            var rowCheckIn = convertDate(formattedCheckIn);



            var intRowPrix = parseInt(rowPrix, 10);
            console.log(`rowN_chamber is ${rowN_chamber}`)
            ///////////////// OPEN UPDATE MODAL ///////////////////////////////////////
            // console.log(this.getAttribute('data-row-filePath'))
            // console.log(`value is ${rowfilePath}`)
            // console.log(rowN_chamber)

            $('#id_input').val(rowId);
            $("#ferst_Name_update").val(rowPrenom);
            $("#last_name_update").val(rowNom);
            $("#FaitDate_update").val(rowFait);
            // $('#display_file_update').val(rowfilePath)
            // $("#chamber_update").val(rowN_chamber);
            populateSelectFromString("chamber_update", rowN_chamber)
            $("#startDate_update").val(rowCheckIn);
            $("#endDate_update").val(rowCheckOut);
            $("#Num_phone_update").val(rowNum_phone);
            // $("#filePath_update").val(rowfilePath);
            $("#totalPrice_update").val(rowPrix);
            $("#amountPaid_update").val(this.getAttribute('data-row-Prix-R'));
            $("#N_T_update").val(rowN_T);
            $("#Typedereservation_update").val(this.getAttribute('data-row-Typedereservation'));
            $("#modepaiment_update").val(this.getAttribute('data-row-modepaiment'));
            $("#filePath_update").val(this.getAttribute('data-row-filePath'));
            $("#remainingAmount_update").val();

            // $("#typeAppointment_update").val(typeAppointment)
            // $("#motif_update").val(Motif)
            

        });
    });


    function populateModal(row, id) {
        console.log('RAW IS', row)
        console.log('ID IS', id, `Doctor_id_${id.nom}`)
        if (row) {

            // var Patient_id = row.querySelector('.Patient_id-column').innerText.replace(/\s/g, '');
            // var Doctor_id = $(`#Doctor_id_${id}`).html().replace(/\s/g, '');
            // var Patient_id = $(`#Patient_id_${id}`).html().replace(/\s/g, '');
            // var totalPrice = $(`#totalPrice_${id}`).html().replace(/\s/g, '');
            // var amountPaid = $(`#amountPaid_${id}`).html().replace(/\s/g, '');
            // var typeAppointment = $(`#typeAppointment_${id}`).html().replace(/\s/g, '');
            // var Motif = $(`#Motif_${id}`).html();
            // var StartTime = row.querySelector('.Start_time-column').innerText.replace(/\s/g, '');
            // var StartDate = row.querySelector('.Start_Date-column').innerText.replace(/\s/g, '');



            // var start = $(`#start${id}`).html().replace(/\s/g, '');
            // var end = $(`#end${id}`).html().replace(/\s/g, '');
            // console.log('START',start,secondToDate(start))
            // console.log('end',end,secondToDate(end))
            // var start = row.querySelector('.start-column').innerText.replace(/\s/g, '');
            // var end = row.querySelector('.end-column').innerText.replace(/\s/g, '');



            // var Doctor_id = row.querySelector('.Doctor_id-column').innerText;

            // var lastName = row.querySelector('.last-name-column').innerText;
            // var mobile = row.querySelector('.mobile-column').innerText;
            // var cin = row.querySelector('.cin-column').innerText;
            // var cnss = row.querySelector('.cnss-column').innerText;
            // var birthday = row.querySelector('.birthday-column').innerText;
            // var birthday = document.querySelector('.birthday-column').innerText;
            // var imgSrc = row.getElementsByTagName("img")[0];
            // var mutualType = row.querySelector('.mutualType-column').innerText;


            // var email = row.querySelector('.email-column')?.innerText;
            // var id = row.querySelector('.id-column')?.innerText;
            // var gender = row.querySelector('.gender-column')?.innerText;
            // var bloodGroup = row.querySelector('.blood-group-column')?.innerText;
            // var status = row.querySelector('.status-column')?.innerText;
            // Add more variables for other columns
            // console.log("bloodGroup", bloodGroup.substring(0, 4), bloodGroup.substring(0, 4).length)
            // console.log("gender", gender)
            // console.log("birthday", birthday, birthday.length)

            // Now you can use these variables to populate your modal fields
            // var modal = document.querySelector('#modal-edit');
            // var modal = document.querySelector('#modal-edit');
            // modal.querySelector('.modal-title').innerText = firstName + ' ' + lastName;
            // modal.querySelector('#first_name_input').value = firstName;
            // modal.querySelector('#last_name_input').value = lastName;
            // modal.querySelector('#mobile_no_input').value = mobile;
            // modal.querySelector('#patient_cin_input').value = cin;
            // modal.querySelector('#patient_cnss_input').value = cnss;
            // modal.querySelector('#email_input').value = email;
            // modal.querySelector('#gender_input').value = gender;
            // modal.querySelector('#id_input').value = id;
            // modal.querySelector('#blood_group_input_edit').value = bloodGroup.substring(0, 4);
            // let date = formatDateStringForInput(birthday);
            //console.log("DATE IS ", date, date.length);
            //$("#birthday_input_edit").val("2015-12-28")
            // $("#birthday_input_edit").val(birthday.replace(/\s/g, ''))
            // $("#marital_status_input").val(status)
            // $("#mutuelle_type_input").val(mutualType.replace(/\s/g, ''))
            // console.log(mutualType, mutualType.length)
            // $('#blood_group_input_edit').val(bloodGroup.replace(/\s/g, ''));


            // $('#blood_group_input_edit').val("AB+");

            // modal.querySelector('#birthday_input_edit').value = formatDateStringForInput(birthday);
            // console.log("Before:", birthday);
            // birthday = "20-01-2001";
            // console.log("After:", birthday);


            // Add more lines to populate additional fields
        }
    }

    function secondToDate(timestamp) {
        var date = new Date(timestamp);


        if (isNaN(date.getTime())) {
            return "Invalid Date";
        }
        // Format the date as a string in the "YYYY-MM-DD" format
        var formattedDate = date.toISOString().replace('Z', '');
        return formattedDate;
    }
    
    function addEvent() {
        const selectedValues = $('#chamber').val(); 
        const formattedString = selectedValues.join('/');
        // console.log(`formattedString is ${formattedString}`)
        
        // final_data=$('#formattedValues').val(formattedString);
        // Your form validation logic goes here
        const ferstName = document.getElementById('ferst_Name').value;
        const lastName = document.getElementById('last_name').value;
        const Num_phone = document.getElementById('Num_phone').value;
        // const chamber = document.getElementById('chamber').value;
        const chamber = formattedString;
        var   filePath = document.getElementById('filePath').value;
        var   startDate = document.getElementById('startDate').value;
        var   endDate = document.getElementById('endDate').value;
        var   FaitDate = document.getElementById('FaitDate').value;
        const totalPrice = parseFloat(document.getElementById('totalPrice').value) || 0;
        const amountPaid = parseFloat(document.getElementById('amountPaid').value) || 0;
        // const remainingAmount = parseFloat(document.getElementById('remainingAmount').value) || 0;
        const modepaiment = document.getElementById('modepaiment').value;
        const N_T = document.getElementById('N_T').value;
        const typeAppointment = document.getElementById('typeAppointment').value;

        startDate = formatDate(startDate);
        endDate = formatDate(endDate);
        FaitDate = formatDate(FaitDate);
        // console.log("Formatted date:", FaitDate);
        // console.log(filePath);
        // var correctedFilePath = filePath.replace(/\\/g, '/');
        correctedFilePath = filePath.replace('C:\\fakepath', 'C:\\Users\\HP PLAZA\\Documents\\SCANNER');
        console.log(correctedFilePath);

        if (startDate == null || endDate==null) {
            Swal.fire({
                icon: 'error',
                title: 'Validation Error!',
                text: 'Formatted date incorrect',
            });
            return;
        }else

        // Clear previous error messages
        $('.error-message').text('');

        // Validation logic
        var isValid = true;
        if (!ferstName || !lastName || chamber === "Select Chamber..." || !startDate || !endDate ||
            isNaN(totalPrice) || isNaN(amountPaid) || typeAppointment === "Select Type") {
            Swal.fire({
                icon: 'error',
                title: 'Validation Error!',
                text: 'Please fill in all required fields.',
            });
            return;
        }

        // Check if end date is greater than start date
        var startDateTime = new Date(startDate);
        var endDateTime = new Date(endDate);
  

        // if (endDateTime <= startDateTime) {
        //     Swal.fire({
        //         icon: 'error',
        //         title: 'Validation Error!',
        //         text: 'End date must be greater than the start date.',
        //     });
        //     return;
        // }


        // If validation passes, proceed with AJAX request
        const eventData = {
            // Customize this based on your data structure
            firstName: ferstName,
            lastName: lastName,
            chamber: chamber,
            startDate: startDate,
            endDate: endDate,
            FaitDate: FaitDate,
            Num_phone: Num_phone,
            filePath: correctedFilePath || "",
            extendedProps: {
                totalPrice: totalPrice,
                amountPaid: amountPaid,
                N_T: N_T,
                typeAppointment: typeAppointment,
                modepaiment: modepaiment,
            }
        };

        // print(eventData)

        // console.log("eventData", eventData)
        // alert('see the console')
        var csrfToken = $('[name="csrfmiddlewaretoken"]').val();

        // AJAX request
        $.ajax({
            type: 'POST',
            url: url,
            data: JSON.stringify(eventData),
            beforeSend: function (xhr) {
                xhr.setRequestHeader('X-CSRFToken', csrfToken);
            },
            contentType: 'application/json',
            success: function (response) {
                if (response.success) {
                    Swal.fire({
                        icon: 'success',
                        title: 'Success',
                        text: 'Appointment added',
                    });
                    // Optionally, you can reset the form or perform other actions
                } else {
                    Swal.fire({
                        icon: 'error',
                        title: 'Failed',
                        text: 'Failed to save event data.',
                    });
                }
            },
            error: function () {
                Swal.fire({
                    icon: 'error',
                    title: 'Request Failed',
                    text: 'Failed to save event data.',
                });
            }
        });
    }

    function calculateTotalPrice() {
        var rows = document.querySelectorAll('#example3 tbody tr');
        var totalPrice = 0;
        rows.forEach(function(row) {
            var talabiaColumn = row.querySelector('.Prix-column');
            

            // Check if talabiaColumn and livColumn are not null before accessing textContent
            if (talabiaColumn) {
                var talabiaPrice = parseFloat(talabiaColumn.textContent) || 0; // Default to 0 if price is not available or not a number
                totalPrice += talabiaPrice;
            }
        });
        return totalPrice;
    }

    function updateTotalPriceOutput() {
        calculateTotalPrice();
        filterByPrice();
    }

    // Call the function to update the total price output element when the document is loaded
    document.addEventListener('DOMContentLoaded', function() {
        updateTotalPriceOutput();

        // MutationObserver to detect changes in the table content
        var observer = new MutationObserver(function(mutationsList) {
            updateTotalPriceOutput();
        });

        observer.observe(document.getElementById('example3'), { subtree: true, childList: true });
    });

    // Add event listener to the date range input (optional if you need to refresh the total price when the date range changes)
    document.getElementById('daterange').addEventListener('change', function() {
        updateTotalPriceOutput();
    });

    function add() {


        // Your form validation logic goes here
        const ferstName = document.getElementById('ferst_Name_update').value;
        const lastName = document.getElementById('last_name_update').value;
        var FaitDate = document.getElementById('FaitDate_update').value;
        const chamber = document.getElementById('chamber_update').value;
        const Num_phone = document.getElementById('Num_phone_update').value;
        var   startDate = document.getElementById('startDate_update').value;
        var   endDate = document.getElementById('endDate_update').value;
        const totalPrice = parseFloat(document.getElementById('totalPrice_update').value) || 0;
        const amountPaid = parseFloat(document.getElementById('amountPaid_update').value) || 0;
        // const remainingAmount = parseFloat(document.getElementById('remainingAmount').value) || 0;
        const modepaiment = document.getElementById('modepaiment_update').value;
        const N_T = document.getElementById('N_T_update').value;
        const typeAppointment = document.getElementById('Typedereservation_update').value;
        var filePath = document.getElementById('filePath_update').value;

        startDate = formatDate(startDate);
        endDate = formatDate(endDate);
        FaitDate = formatDate(FaitDate);
        // console.log("Formatted date:", startDate);

        correctedFilePath = filePath.replace('C:\\fakepath', 'C:\\Users\\HP PLAZA\\Documents\\SCANNER');
        console.log(correctedFilePath);

        if (startDate == null || endDate==null) {
            Swal.fire({
                icon: 'error',
                title: 'Validation Error!',
                text: 'Formatted date incorrect',
            });
            return;
        }else

        // Clear previous error messages
        $('.error-message').text('');

        // Validation logic
        var isValid = true;
        if (!ferstName || !lastName || chamber === "Select Chamber..." || !startDate || !endDate ||
            isNaN(totalPrice) || isNaN(amountPaid) || typeAppointment === "Select Type") {
            Swal.fire({
                icon: 'error',
                title: 'Validation Error!',
                text: 'Please fill in all required fields.',
            });
            return;
        }

        // Check if end date is greater than start date
        var startDateTime = new Date(startDate);
        var endDateTime = new Date(endDate);

        // if (endDateTime <= startDateTime) {
        //     Swal.fire({
        //         icon: 'error',
        //         title: 'Validation Error!',
        //         text: 'End date must be greater than the start date.',
        //     });
        //     return;
        // }

        // If validation passes, proceed with AJAX request
        const eventData = {
            // Customize this based on your data structure
            firstName: ferstName,
            lastName: lastName,
            chamber: chamber,
            startDate: startDate,
            endDate: endDate,
            FaitDate: FaitDate,
            Num_phone: Num_phone,
            filePath: correctedFilePath || "F",
            extendedProps: {
                totalPrice: totalPrice,
                amountPaid: amountPaid,
                N_T: N_T,
                typeAppointment: typeAppointment,
                modepaiment: modepaiment,
            }
        };

        // console.log("eventData", eventData)
        // alert('see the console')
        var csrfToken = $('[name="csrfmiddlewaretoken"]').val();
        Swal.fire({
        title: 'Are you sure?',
        text: 'You wan\'t to add this!',
        icon: 'warning',
        showCancelButton: true,
        confirmButtonColor: '#f44336',
        cancelButtonColor: '#3085d6',
        confirmButtonText: 'Yes, Add it!'
        }).then((result) => {
            if (result.isConfirmed) {
                // AJAX request
                $.ajax({
                    type: 'POST',
                    url: url,
                    data: JSON.stringify(eventData),
                    beforeSend: function (xhr) {
                        xhr.setRequestHeader('X-CSRFToken', csrfToken);
                    },
                    contentType: 'application/json',
                    success: function (response) {
                        if (response.success) {
                            Swal.fire({
                                icon: 'success',
                                title: 'Success',
                                text: 'Appointment added',
                            });
                            // Optionally, you can reset the form or perform other actions
                        } else {
                            Swal.fire({
                                icon: 'error',
                                title: 'Failed',
                                text: 'Failed to save event data.',
                            });
                        }
                    },
                    error: function () {
                        Swal.fire({
                            icon: 'error',
                            title: 'Request Failed',
                            text: 'Failed to save event data.',
                        });
                    }
                });
            }
        });
    }

    function formatDate(inputDate) {
    // Check if the input date matches the format "YYYY-MM-DD"
    const datePattern = /^\d{4}-\d{2}-\d{2}$/;
    if (!datePattern.test(inputDate)) {
        // If the input date doesn't match the format, display an alert and return null
        alert("Please enter a valid date in YYYY-MM-DD format.");
        return null;
    }

    // Split the date string into its components
    const parts = inputDate.split('-');

    // Rearrange the components to the "DD/MM/YYYY" format
    const formattedDate = `${parts[2]}/${parts[1]}/${parts[0]}`;

    return formattedDate;
    }


    function submitForm() {
        console.log($('#chamber_update').val())

        const selectedValues = $('#chamber_update').val(); 
        const formattedString = selectedValues.join('/');
        final_data=$('#formattedValues').val(formattedString);

        
        
        // alert("submit")
        // Get form data
        const id = $('#id_input').val();
        filePath_update = $('#filePath_update').val() ?? ""
        correctedFilePath = filePath_update.replace('C:\\fakepath', 'C:\\Users\\HP PLAZA\\Documents\\SCANNER');
        // alert('id'+id)
        var formData = {
            id: $('#id_input').val(),
            startDate_update: $('#startDate_update').val(),
            endDate_update: $('#endDate_update').val(),
            ferst_Name_update: $('#ferst_Name_update').val(),
            last_name_update: $('#last_name_update').val(),
            // chamber_update: $('#chamber_update').val(),
            chamber_update: formattedString,
            totalPrice: $('#totalPrice_update').val(),
            amountPaid_update: $('#amountPaid_update').val(),
            N_T_update: $('#N_T_update').val(),
            Typedereservation_update: $('#Typedereservation_update').val(),
            modepaiment_update: $('#modepaiment_update').val(),
            FaitDate_update: $('#FaitDate_update').val(),
            
            Num_phone_update: $('#Num_phone_update').val(),
            filePath_update: correctedFilePath || "",
            id: id,
        };
        
        console.log($('#id_input').val());

        console.log("formData", formData)
        var csrfToken = $('[name="csrfmiddlewaretoken"]').val();
        // Send data using AJAX

        Swal.fire({
        title: 'Are you sure?',
        text: 'You wan\'t to update this!',
        icon: 'warning',
        showCancelButton: true,
        confirmButtonColor: '#f44336',
        cancelButtonColor: '#3085d6',
        confirmButtonText: 'Yes, update it!'
        }).then((result) => {
            if (result.isConfirmed) {
                $.ajax({
                    type: 'POST',
                    url: updateUrl.replace('pk_placeholder', id),  // Use the URL name defined in your urls.py

                    data: formData,
                    beforeSend: function (xhr) {
                        xhr.setRequestHeader('X-CSRFToken', csrfToken);
                    },
                    success: function (response) {
                        // Handle the success response
                        Swal.fire({
                            icon: 'success',
                            title: 'Success',
                            text: 'Updated  ',
                        });
                        // $('#modal-edit').hide();
                        console.log(response);
                    },
                    error: function (error) {
                        // Handle the error
                        console.error(error);
                    }
                });
            }
        });
    }

    function filterByPrice() {
        var filterValue = document.getElementById('priceFilter').value;
        var rows = document.querySelectorAll('#example3 tbody tr');
        var totalRevenue = 0;
        var totalSortie = 0;
        var totalEnter = 0;
        var modepaimentCash = 0;
        var modepaimentCart = 0;

        rows.forEach(function(row) {
            var priceCell = row.querySelector('.Prix-column');
            var modepaiment = row.querySelector('.modepaiment-column');
            var price = parseFloat(priceCell?.textContent) || 0;
            var allmodepaiment = modepaiment.textContent || null;

            // console.log(allmodepaiment)

            if (filterValue === 'all') {
                row.style.display = '';
                if (price > 0) {
                    totalRevenue += price;
                    totalEnter += price;
                    if (allmodepaiment == "Cash")
                        modepaimentCash += price
                    if (allmodepaiment == "Visa Card")
                        modepaimentCart += price
                        
                } else {
                    totalRevenue += price;
                    totalSortie += price;
                    if (allmodepaiment == "Cash")
                        modepaimentCash += price
                    if (allmodepaiment == "Visa Card")
                        modepaimentCart += price
                }
            } else if (filterValue === 'positive' && price > 0) {
                row.style.display = '';
                if (price > 0) {
                    totalEnter += price;
                } else {
                    totalSortie += price;
                }
                if (allmodepaiment == "Cash")
                    modepaimentCash += price
                if (allmodepaiment == "Visa Card")
                    modepaimentCart += price
            } else if (filterValue === 'negative' && price < 0) {
                row.style.display = '';
                if (price > 0) {
                    totalEnter += price;
                } else {
                    totalSortie += price;
                }
                if (allmodepaiment == "Cash")
                    modepaimentCash += price
                if (allmodepaiment == "Visa Card")
                    modepaimentCart += price
            } else {
                row.style.display = 'none';
            }
        });

        document.getElementById('totalPriceOutput').textContent = totalRevenue.toFixed(2);
        document.getElementById('totalSortieOutput').textContent = totalSortie.toFixed(2);
        document.getElementById('totalEnterOutput').textContent = totalEnter.toFixed(2);
        document.getElementById('modepaimentCash').textContent = modepaimentCash.toFixed(2);
        document.getElementById('modepaimentCart').textContent = modepaimentCart.toFixed(2);
        return totalSortie;
    }

    // Call this function initially to set the correct totals
    filterByPrice();


    ////// Delete ////////////////////////

    function deleteAppointment(appointmentId) {
    var csrfToken = $('[name="csrfmiddlewaretoken"]').val();

    Swal.fire({
        title: 'Are you sure?',
        text: 'You wan\'t be able to revert this!',
        icon: 'warning',
        showCancelButton: true,
        confirmButtonColor: '#d33',
        cancelButtonColor: '#3085d6',
        confirmButtonText: 'Yes, delete it!'
    }).then((result) => {
        if (result.isConfirmed) {
            Swal.fire({
                title: 'PIN CODE',
                html: `
                <div class="pin-code" style="display: flex; justify-content: center; gap: 10px;">
                    <input type="password" maxlength="1" autofocus class="pin-input" style="width: 50px; padding: 10px; border: 1px solid #ccc; border-radius: 4px; text-align: center;">
                    <input type="password" maxlength="1" autofocus class="pin-input" style="width: 50px; padding: 10px; border: 1px solid #ccc; border-radius: 4px; text-align: center;">
                    <input type="password" maxlength="1" autofocus class="pin-input" style="width: 50px; padding: 10px; border: 1px solid #ccc; border-radius: 4px; text-align: center;">
                    <input type="password" maxlength="1" autofocus class="pin-input" style="width: 50px; padding: 10px; border: 1px solid #ccc; border-radius: 4px; text-align: center;">
                </div>
                `,
                focusConfirm: false,
                preConfirm: () => {
                    let pinCode = '';
                    document.querySelectorAll('.pin-input').forEach((input) => {
                        pinCode += input.value;
                    });                    
                    return pinCode; // If pin code is correct
                },
                onOpen: () => {
                    // Auto-focus on the first input and setup input behavior
                    const inputs = document.querySelectorAll('.pin-input');
                    inputs[0].focus();
                    inputs.forEach((input, index) => {
                        input.addEventListener('input', () => {
                            input.value = input.value.slice(0, 1); // Ensure single digit
                            if (index < inputs.length - 1) {
                                inputs[index + 1].focus(); // Move to next input
                            }
                        });
                    });
                }
            }).then((pinResult) => {
                if (pinResult.value) {
                    // Proceed with the deletion if the pin is correct
                    var pinCode = pinResult.value;
                    
                    $.ajax({
                        type: 'POST',
                        url: deleteUrl.replace('pk_placeholder', appointmentId),
                        data: {
                            appointment_id: appointmentId,
                            pin_code: pinCode
                        },
                        beforeSend: function (xhr) {
                            xhr.setRequestHeader('X-CSRFToken', csrfToken);
                        },
                        success: function (response) {
                            if (response.success) {
                                Swal.fire('Deleted!', 'Your reservation has been deleted.', 'success');
                                $(`#${appointmentId}`).hide();
                            } else {
                                Swal.fire('Error', 'An error occurred while deleting the reservation.', 'error');
                            }
                        },
                    });
                }
            });
        }
    });
}

    //////////////////////// ONKEY UP /////////////////////////////
    // function calculateRemainingAmount(update = null) {
    //     var totalPrice = "";
    //     var amountPaid = "";
    //     var remainingAmount = "";
    //     if (!update) {
    //         totalPrice = parseFloat(document.getElementById('totalPrice').value) || 0;
    //         amountPaid = parseFloat(document.getElementById('amountPaid').value) || 0;
    //         remainingAmountClass = "remainingAmount"
    //     } else {
    //         totalPrice = parseFloat(document.getElementById('totalPrice_update').value) || 0;
    //         amountPaid = parseFloat(document.getElementById('amountPaid_update').value) || 0;
    //         remainingAmountClass = "remainingAmount_update";
    //     }
    //     console.log(totalPrice, amountPaid, remainingAmountClass)
    //     var remainingAmount = totalPrice - amountPaid;
    //     document.getElementById(remainingAmountClass).value = remainingAmount.toFixed(2);
    //     var paymentStatusIcon = document.getElementById('paymentStatusIcon');
    //     console.log(remainingAmount);
    //     if (remainingAmount === 0) {
    //         paymentStatusIcon.className = 'fas fa-check-circle text-success'; // Icon for payment complete
    //     } else {
    //         paymentStatusIcon.className = 'fas fa-exclamation-circle text-warning'; // Icon for remaining amount
    //     }
    // }


    ////////////////////////////GET Select Chambre Format  ////////////////////

    function populateSelectFromString(selectId, stringValue) {
        console.log("in populateSelectFromString",selectId,stringValue)
        var selectTag = $("#" + selectId);
        var selectedArray = stringValue.split('/');
        
        // Deselect all options first
        selectTag.val(null).trigger('change');
        selectedArray.forEach(function(value){
            selectTag.find('option[value="' + value + '"]').prop('selected', true);
        });

        selectTag.trigger('change');
    }
    ////////////////////////////GET NAME ////////////////////
    function getSelectedOptionId(selectId) {
        const selectElement = document.getElementById(selectId);
        const selectedOption = selectElement.options[selectElement.selectedIndex];
        return selectedOption.value;
    }


    function getSelectedOptionIdValue(selectId) {
        const selectElement = document.getElementById(selectId);
        const selectedOption = selectElement.options[selectElement.selectedIndex];
        $(`#${selectId}`).text = selectedOption.value;
    }
</script>
{% endblock %}